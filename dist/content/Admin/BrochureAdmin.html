<div class="contentTitle clearfix">
  <h3>物品管理</h3>
  <div class="form-group pull-right col-xs-12 col-sm-6 col-md-4" id="tableQuery">
    <div class="form-group col-xs-9">
      <input type="text" class="form-control" name="search_box" id="search_box" placeholder="在这里输入关键字" />
    </div>
    <button type="submit" class="btn btn-primary col-xs-3">Query</button>
  </div>
</div>

<div class="operation-menu">
  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#AddBrochure">添加物品</button>
</div>

<div class="table-content tab-content">
  <div class="tab-pane active" id="Brochure-table-container">
    <table class="table table-bordered table-hover">
    </table>
  </div>
  <nav style="text-align: center">
    <ul class="pagination">
      <li><a href="#">&laquo;</a></li>
      <li><a href="#">1</a></li>
      <li><a href="#">2</a></li>
      <li><a href="#">3</a></li>
      <li><a href="#">4</a></li>
      <li><a href="#">5</a></li>
      <li><a href="#">&raquo;</a></li>
    </ul>
  </nav>
</div>
<script>
  var CurrentTableList = {
    // "#Brochure-table-container": "./test/admin/Brochure/Inventory.json"
  }
</script>

    <div class="modal fade" id="histroy" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">出入库详情</h4>
      </div>

      <div class="modal-body">
        <div class="modal-infopart goodsInfomation infomationTable">
        </div>
      </div>
      <div class="modal-footer">
        <div class="modal-infopart Approval">
        </div>
      </div>
    </div>
  </div>
</div>

  

  
    <div class="modal fade" id="AddBrochure" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dimdiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">添加物品</h4>
      </div>

      <div class="modal-body clearfix">
        <form id="add_Brochure" class="form" role="form">
          <div class="form-group col-md-12">
            <label for="_brochurename" class="control-label">物品名称:</label>
            <input name="_brochurename" id="_brochurename" placeholder="请输入物品名称" class="form-control" />
          </div>
          <div class="form-group col-md-12">
            <label for="_quantity" class="control-label">物品数量:</label>
            <input name="_quantity" id="_quantity" placeholder="请输入物品数量" class="form-control" />
          </div>
          <div class="form-group col-md-12 search_box_wapper">
            <label for="_supplierfk" class="control-label">供应商 :</label>
            <input name="_supplierfk" id="_supplierfk" placeholder="供应商名称" class="form-control" />
            <ul class="dropdown-menu keyhint"></ul>
          </div>
          <div class="form-group col-md-12">
            <label for="_purposefk" class="control-label">用途:</label>
            <select name="_purposefk" id="_purposefk" class="form-control">
                <option value="-1" selected>请选择用途</option>
                <option value="0">一般销售用途</option>
                <option value="1">区域会议</option>
                <option value="2">全国性会议</option>
              </select>
          </div>
          <div class="Comments editable col-md-12" id="_description">
            <span>备注：</span>
            <textarea name="_description" rows="4"></textarea>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="submit" class="btn btn-primary center-block col-xs-12" onclick="addBrochure()">添加</button>
      </div>
    </div>
  </div>
</div>
<script>
  function addBrochure() {
    var data = formToSet("#add_Brochure")
    var dealerId = POST("/api/brochure/new", data)
    if (dealerId) {
      $("#AddBrochure").modal("hide")
      ClearInputs("#add_Brochure")
      ClearSelecton("#add_Brochure")
      ClearTextArea("#add_Brochure")
    }
    BrochureAdmin()
  }
</script>

  

    
    <div class="modal fade" id="EditBrochure" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">编辑物品</h4>
      </div>

      <div class="modal-body clearfix">
        <form id="edit_Brochure" class="form" role="form">
            <div class="form-group col-md-4">
              <label for="BrochureName">物品名称:</label>
              <input name="BrochureName" id="BrochureName" placeholder="请输入物品名称" class="form-control" />
            </div>
            <div class="form-group col-md-4">
              <label for="PONumber">PONumber:</label>
              <input name="PONumber" id="PONumber" placeholder="请输入PONumber" class="form-control" />
            </div>
            <div class="form-group col-md-4">
              <label for="Quantity">物品数量:</label>
              <input name="Quantity" id="Quantity" placeholder="请输入物品数量" class="form-control" />
            </div>
            <div class="form-group col-md-12">
              <label for="PurposeFK">用途:</label>
              <!--<input type="text" name="PurposeFK" id="PurposeFK" value="PurposeFK" hidden>-->
              <select name="PurposeFK" id="PurposeFK" class="form-control">
                <option value="-1" selected>请选择用途</option>
                <option value="forSales">一般销售用途</option>
                <option value="partMeeting">区域会议</option>
                <option value="nationalMeeting">全国性会议</option>
              </select>
            </div>
            <div class="Comments editable col-md-12" id="Description">
                <span>备注：</span>
                <textarea name="Description" rows="4"></textarea>
              </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="submit" class="btn btn-primary center-block col-xs-12">完成</button>
      </div>
    </div>
  </div>
</div>

  

      
    <div class="modal fade" id="delete">
  <div class="modal-dialog">
    <div class="modal-content message_align">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h4 class="modal-title">提示信息</h4>
      </div>
      <div class="modal-body">
        <p>您确认要删除吗？</p>
      </div>
      <div class="modal-footer">
        <input type="hidden" id="url" />
        <a onclick="urlSubmit()" class="btn btn-danger" data-dismiss="modal">确定</a>
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
      </div>
    </div>
  </div>
</div>

  

        
    <div class="modal fade" id="supply" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">补充入库</h4>
      </div>

      <div class="modal-body">
        <form id="Supply" class="form-horizontal" role="form">
            <div class="form-group">
              <label class="col-sm-4 control-label" for="quantitySupply">补充数量：</label>
              <div class="col-sm-8">
                <input type="Common.Supply" class="form-control" name="quantitySupply" id="quantitySupply" placeholder="请输入补充数量" />
              </div>
            </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="submit" class="btn btn-primary center-block col-xs-12" onclick="quantitySupply()">完成</button>
      </div>
    </div>
  </div>
</div>
<script>
  function quantitySupply() {
    var beforeQuantity = window.targrt_brochure["Quantity"]
    window.targrt_brochure["Quantity"] = parseInt($("#quantitySupply").val()) + parseInt(beforeQuantity)
    console.log(window.targrt_brochure);
    for(var i in window.targrt_brochure){
      window.targrt_brochure["_"+i.toLowerCase()] = window.targrt_brochure[i]
    }
    PUT('/api/brochure/' + window.targrt_brochure["ID"] + '/update', window.targrt_brochure)
    window.targrt_brochure = null
    $("#supply").modal('hide')
    ClearInputs("#Supply")
    ClearSelecton("#Supply")
    ClearTextArea("#Supply")
    BrochureAdmin()
  }
</script>

  

          <script>
            var BrochureAdmin = function() {
              var templateOpts = {
                "tablename": "goods",
                "hasHeader": true,
                "hasButton": true,
                "buttonPool": ["supplyBtn", "historyBtn", "editBtn", "delBtn"],
                "keyArr": ["id", "key", "key", "prop", "prop", "prop"],
                "data": [
                  ["序列", "物品编号", "物品名称", "物品数量", "供应商", "创建时间"],
                ]
              }
              var dataOrder = ["_id", "_brochurenumber", "_brochurename", "_quantity", "_purposefk", "_createtime"]
              new table().loadFromTemplateJson("/api/brochure/top(100)", templateOpts, dataOrder).to("#Brochure-table-container")
            }
            BrochureAdmin()
            var del = function(rid) {
              $("#delete")
                .modal()
            }
            var supply = function(rid) {
              window.targrt_brochure = GET("/api/brochure/" + rid)
              $("#supply")
                .modal()
            }
            var supplyment = function(rid) {

            }
            var history = function(rid) {
              $("#history")
                .modal()
            }
            var edit = function(rid) {
              $("#edit")
                .modal()
            }
          </script>
